import { Column, Entity, Index, ManyToOne } from 'typeorm';
import { BaseSchema } from '../../../common/base-schema.entity';
import { ScanEvent } from './scan-event.entity';

/**
 * The vulnerability entity
 */
@Entity({ name: 'vulnerabilities' })
export class Vulnerability extends BaseSchema {
  /**
   * The path where the vulnerability is found
   */
  @Column()
  path!: string;

  /**
   * The line where the vulnerability is found
   */
  @Column()
  line!: number;

  /**
   * The scan event of the vulnerability
   */
  @Index()
  @ManyToOne(() => ScanEvent, (scanEvent) => scanEvent.vulnerabilities)
  scanEvent: ScanEvent;
}
